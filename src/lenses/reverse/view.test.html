<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reverse Lens Component Test</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        border: 2px solid #ddd;
        border-radius: 8px;
        background: white;
      }
      .test-section.pass {
        border-color: #28a745;
        background: #f8fff9;
      }
      .test-section.fail {
        border-color: #dc3545;
        background: #fff8f8;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
      }
      .checklist {
        margin: 10px 0;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
      }
      .checklist li {
        margin: 5px 0;
      }
      .expected {
        color: #666;
        font-style: italic;
        background: #e9ecef;
        padding: 8px;
        border-radius: 4px;
        margin: 10px 0;
      }
      h1 {
        color: #007acc;
      }
      h2 {
        color: #333;
        margin-top: 0;
      }
    </style>
  </head>
  <body>
    <h1>üß™ Reverse Lens Component Test</h1>
    <p>
      Testing the reverse lens web component functionality with various inputs and configurations.
    </p>

    <!-- Test 1: Basic functionality -->
    <div class="test-section">
      <h2>Test 1: Basic Code Reversal</h2>
      <div class="expected">
        <strong>Expected:</strong> Should reverse "hello world" to "dlrow olleh"
      </div>

      <sl-lens-reverse code="hello world"></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Component renders without errors</li>
          <li>‚òê Output shows "dlrow olleh"</li>
          <li>‚òê No console errors in browser dev tools</li>
          <li>‚òê Component appears in DOM inspector as custom element</li>
        </ul>
      </div>
    </div>

    <!-- Test 2: JavaScript code -->
    <div class="test-section">
      <h2>Test 2: JavaScript Code Reversal</h2>
      <div class="expected">
        <strong>Expected:</strong> Should reverse JavaScript function code character by character
      </div>

      <sl-lens-reverse code="function test() { return 42; }"></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê JavaScript code is reversed correctly</li>
          <li>‚òê All special characters (braces, semicolons) are preserved</li>
          <li>‚òê Output: "} ;24 nruter { )(tset noitcnuf"</li>
          <li>‚òê Component handles code formatting properly</li>
        </ul>
      </div>
    </div>

    <!-- Test 3: File loading -->
    <div class="test-section">
      <h2>Test 3: File Path Loading</h2>
      <div class="expected">
        <strong>Expected:</strong> Should load and reverse code from external file
      </div>

      <sl-lens-reverse code="../examples/content/greet.js"></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê File content loads correctly (or shows appropriate error)</li>
          <li>‚òê Loaded code is reversed properly</li>
          <li>‚òê Language metadata preserved from file extension</li>
          <li>‚òê Error handling for missing files works gracefully</li>
        </ul>
      </div>
    </div>

    <!-- Test 4: Empty and edge cases -->
    <div class="test-section">
      <h2>Test 4: Edge Cases</h2>
      <div class="expected">
        <strong>Expected:</strong> Should handle edge cases without crashing
      </div>

      <h3>Empty Code:</h3>
      <sl-lens-reverse code=""></sl-lens-reverse>

      <h3>Single Character:</h3>
      <sl-lens-reverse code="x"></sl-lens-reverse>

      <h3>Special Characters:</h3>
      <sl-lens-reverse code="!@#$%^&*()"></sl-lens-reverse>

      <h3>Multiline Code:</h3>
      <sl-lens-reverse
        code="line1
line2
line3"
      ></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Empty code handled without errors</li>
          <li>‚òê Single character "x" remains "x"</li>
          <li>‚òê Special characters reversed: ")(*)&^%$#@!"</li>
          <li>‚òê Multiline code preserves newlines in reverse</li>
          <li>‚òê No JavaScript errors in any scenario</li>
        </ul>
      </div>
    </div>

    <!-- Test 5: Configuration attributes -->
    <div class="test-section">
      <h2>Test 5: Configuration Options</h2>
      <div class="expected">
        <strong>Expected:</strong> Should accept configuration gracefully (reverse has minimal
        config)
      </div>

      <sl-lens-reverse code="test config" enabled="true"></sl-lens-reverse>
      <sl-lens-reverse code="test disabled" enabled="false"></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Enabled=true works normally: "gifnoc tset"</li>
          <li>‚òê Enabled=false works normally (reverse has basic config): "delbasid tset"</li>
          <li>‚òê Unknown attributes don't break component</li>
          <li>‚òê Configuration parsing doesn't cause errors</li>
        </ul>
      </div>
    </div>

    <!-- Test 6: Integration testing -->
    <div class="test-section">
      <h2>Test 6: Integration with Other Components</h2>
      <div class="expected">
        <strong>Expected:</strong> Should work correctly in pipelines and study panels
      </div>

      <h3>Pipeline Mode (Sequential Processing):</h3>
      <study-lenses lenses="reverse uppercase" code="hello world"></study-lenses>

      <h3>Study Panel Mode (Parallel Views):</h3>
      <study-lenses code="function add(a, b) { return a + b; }">
        <sl-lens-reverse></sl-lens-reverse>
        <sl-lens-uppercase></sl-lens-uppercase>
      </study-lenses>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Pipeline produces "DLROW OLLEH" (reverse then uppercase)</li>
          <li>‚òê Study panel shows both reversed and uppercase versions</li>
          <li>‚òê Code distribution works correctly</li>
          <li>‚òê No conflicts between components</li>
          <li>‚òê Both modes render without errors</li>
        </ul>
      </div>
    </div>

    <!-- Test 7: Stress testing -->
    <div class="test-section">
      <h2>Test 7: Performance and Stress Testing</h2>
      <div class="expected">
        <strong>Expected:</strong> Should handle larger code samples efficiently
      </div>

      <sl-lens-reverse
        code="// Large code sample
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

const result = fibonacci(10);
console.log('Fibonacci result:', result);

// More code to test performance
for (let i = 0; i < 100; i++) {
  console.log('Iteration:', i);
}"
      ></sl-lens-reverse>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Large code sample reverses correctly</li>
          <li>‚òê Performance remains responsive (no significant delay)</li>
          <li>‚òê Memory usage appears reasonable</li>
          <li>‚òê No browser performance warnings</li>
        </ul>
      </div>
    </div>

    <!-- Import and register the component -->
    <script type="module">
      // Register all components needed for testing
      import './register.js';
      import '../../uppercase/register.js';
      import '../../study/register.js';

      console.log('‚úÖ Reverse Lens component test loaded successfully');

      // Add interactive testing helpers to window for manual testing
      window.testReverse = {
        // Helper function to test lens directly
        async testFunction(code, config = {}) {
          const { lens } = await import('./lens.js');
          const { config: configFactory } = await import('./config.js');

          const snippet = { code, lang: 'js', test: false };
          const result = lens(snippet, configFactory(config));

          console.log('Direct lens test result:', result);
          return result;
        },

        // Test multiple inputs quickly
        runBatchTest() {
          const tests = ['hello', 'function() {}', '12345', 'a!@#$%b'];

          console.log('Running batch tests:');
          tests.forEach(async (test, i) => {
            const result = await this.testFunction(test);
            console.log(`Test ${i + 1}: "${test}" ‚Üí "${result.snippet.code}"`);
          });
        },
      };

      // Run some automatic validation
      document.addEventListener('DOMContentLoaded', () => {
        console.log('üîç Performing automatic component validation...');

        // Check that all components are registered
        const reverseElements = document.querySelectorAll('sl-lens-reverse');
        console.log(`Found ${reverseElements.length} reverse lens components`);

        // Validate that components have content after a brief delay
        setTimeout(() => {
          let hasContent = true;
          reverseElements.forEach((el, i) => {
            if (!el.textContent.trim()) {
              console.warn(`‚ö†Ô∏è  Component ${i + 1} has no visible content`);
              hasContent = false;
            }
          });

          if (hasContent) {
            console.log('‚úÖ All components appear to have content');
          } else {
            console.log('‚ùå Some components may not be working correctly');
          }
        }, 1000);
      });
    </script>
  </body>
</html>

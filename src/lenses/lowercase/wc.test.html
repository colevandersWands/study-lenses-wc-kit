<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Lowercase Lens Component Test</title>
		<style>
			body {
				font-family: system-ui, sans-serif;
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
				background: #f5f5f5;
			}
			.test-section {
				margin: 20px 0;
				padding: 20px;
				border: 2px solid #ddd;
				border-radius: 8px;
				background: white;
			}
			.test-section.pass {
				border-color: #28a745;
				background: #f8fff9;
			}
			.test-section.fail {
				border-color: #dc3545;
				background: #fff8f8;
			}
			pre {
				background: #f5f5f5;
				padding: 10px;
				border-radius: 4px;
				overflow-x: auto;
			}
			.checklist {
				margin: 10px 0;
				background: #f8f9fa;
				padding: 15px;
				border-radius: 4px;
			}
			.checklist li {
				margin: 5px 0;
			}
			.expected {
				color: #666;
				font-style: italic;
				background: #e9ecef;
				padding: 8px;
				border-radius: 4px;
				margin: 10px 0;
			}
			h1 {
				color: #007acc;
			}
			h2 {
				color: #333;
				margin-top: 0;
			}
			.transform-output {
				border: 1px solid #ddd;
				margin: 10px 0;
				border-radius: 4px;
				padding: 5px;
			}
		</style>
	</head>
	<body>
		<h1>üß™ Lowercase Lens Component Test</h1>
		<p>
			Testing the sl-lens-lowercase web component that converts code to
			lowercase.
		</p>

		<!-- Test 1: Basic lowercase transformation -->
		<div class="test-section">
			<h2>Test 1: Basic Lowercase Transformation</h2>
			<div class="expected">
				<strong>Expected:</strong> Should convert "HELLO WORLD" to
				"hello world"
			</div>

			<div class="transform-output">
				<sl-lens-lowercase code="HELLO WORLD"></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê Shows "hello world" (all lowercase)</li>
					<li>‚òê Original case is completely converted</li>
					<li>‚òê No console errors</li>
					<li>‚òê Component renders immediately</li>
				</ul>
			</div>
		</div>

		<!-- Test 2: Mixed case text -->
		<div class="test-section">
			<h2>Test 2: Mixed Case Text</h2>
			<div class="expected">
				<strong>Expected:</strong> Should handle mixed case and convert
				all to lowercase
			</div>

			<div class="transform-output">
				<sl-lens-lowercase
					code="HeLLo WoRLd! ThIs Is MiXeD cAsE."
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê All letters converted to lowercase</li>
					<li>‚òê Punctuation and spaces preserved</li>
					<li>‚òê Special characters remain unchanged</li>
					<li>‚òê Output is readable and correct</li>
				</ul>
			</div>
		</div>

		<!-- Test 3: JavaScript code transformation -->
		<div class="test-section">
			<h2>Test 3: JavaScript Code Transformation</h2>
			<div class="expected">
				<strong>Expected:</strong> Should convert JavaScript keywords
				and identifiers to lowercase
			</div>

			<div class="transform-output">
				<sl-lens-lowercase
					code="FUNCTION TEST() { CONST MESSAGE = 'HELLO'; RETURN MESSAGE.TOUPPERCASE(); }"
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê All keywords converted: function, const, return</li>
					<li>‚òê Identifier names converted: test, message</li>
					<li>‚òê String content converted: 'hello'</li>
					<li>‚òê Method names converted: touppercase()</li>
					<li>‚òê Code structure preserved</li>
				</ul>
			</div>
		</div>

		<!-- Test 4: File loading -->
		<div class="test-section">
			<h2>Test 4: File Path Loading</h2>
			<div class="expected">
				<strong>Expected:</strong> Should load file content and convert
				to lowercase
			</div>

			<div class="transform-output">
				<sl-lens-lowercase
					code="../examples/content/greet.js"
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>
						‚òê File loads successfully (or shows appropriate error)
					</li>
					<li>‚òê Loaded content is converted to lowercase</li>
					<li>‚òê File path is resolved correctly</li>
					<li>‚òê Loading state handled appropriately</li>
				</ul>
			</div>
		</div>

		<!-- Test 5: Empty and edge cases -->
		<div class="test-section">
			<h2>Test 5: Empty and Edge Cases</h2>
			<div class="expected">
				<strong>Expected:</strong> Should handle empty strings and
				special cases gracefully
			</div>

			<h3>Empty Code:</h3>
			<div class="transform-output">
				<sl-lens-lowercase code=""></sl-lens-lowercase>
			</div>

			<h3>Numbers and Symbols Only:</h3>
			<div class="transform-output">
				<sl-lens-lowercase
					code="123456 !@#$%^&*() []{}"
				></sl-lens-lowercase>
			</div>

			<h3>Unicode Characters:</h3>
			<div class="transform-output">
				<sl-lens-lowercase
					code="H√âLLO W√ñRLD üöÄ √âMOJIS"
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê Empty code handled without errors</li>
					<li>‚òê Numbers and symbols remain unchanged</li>
					<li>‚òê Unicode characters converted correctly</li>
					<li>‚òê Emoji characters preserved</li>
					<li>‚òê No visual glitches or layout issues</li>
				</ul>
			</div>
		</div>

		<!-- Test 6: Configuration attributes -->
		<div class="test-section">
			<h2>Test 6: Configuration and Attributes</h2>
			<div class="expected">
				<strong>Expected:</strong> Should accept various attributes
				without breaking
			</div>

			<h3>With Lang Attribute:</h3>
			<div class="transform-output">
				<sl-lens-lowercase
					code="PYTHON_CODE = 'HELLO'"
					lang="python"
				></sl-lens-lowercase>
			</div>

			<h3>With Test Attribute:</h3>
			<div class="transform-output">
				<sl-lens-lowercase
					code="DESCRIBE('TEST', () => { EXPECT(TRUE).TOBE(TRUE); });"
					test
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>
						‚òê Lang attribute doesn't interfere with transformation
					</li>
					<li>‚òê Test attribute is handled gracefully</li>
					<li>‚òê Additional attributes don't cause errors</li>
					<li>‚òê Core functionality remains unchanged</li>
				</ul>
			</div>
		</div>

		<!-- Test 7: TextContent fallback -->
		<div class="test-section">
			<h2>Test 7: TextContent as Code Source</h2>
			<div class="expected">
				<strong>Expected:</strong> Should use element textContent when
				no code attribute
			</div>

			<div class="transform-output">
				<sl-lens-lowercase
					>CONSOLE.LOG("HELLO FROM TEXTCONTENT");</sl-lens-lowercase
				>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê TextContent used as code source</li>
					<li>‚òê Content converted to lowercase</li>
					<li>‚òê Fallback mechanism works correctly</li>
					<li>‚òê No duplication of content</li>
				</ul>
			</div>
		</div>

		<!-- Test 8: Multiline code -->
		<div class="test-section">
			<h2>Test 8: Multiline Code Transformation</h2>
			<div class="expected">
				<strong>Expected:</strong> Should preserve line breaks while
				converting case
			</div>

			<div class="transform-output">
				<sl-lens-lowercase
					code="FUNCTION FIBONACCI(N) {
  IF (N <= 1) RETURN N;
  RETURN FIBONACCI(N - 1) + FIBONACCI(N - 2);
}

CONSOLE.LOG(FIBONACCI(10));"
				></sl-lens-lowercase>
			</div>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê All lines converted to lowercase</li>
					<li>‚òê Line breaks preserved</li>
					<li>‚òê Indentation maintained</li>
					<li>‚òê Code structure remains readable</li>
					<li>‚òê Multi-line display works correctly</li>
				</ul>
			</div>
		</div>

		<!-- Test 9: Integration with other components -->
		<div class="test-section">
			<h2>Test 9: Integration in Study Panel</h2>
			<div class="expected">
				<strong>Expected:</strong> Should work correctly within
				study-lenses component
			</div>

			<study-lenses
				code="CONST GREETING = 'HELLO WORLD'; CONSOLE.LOG(GREETING);"
			>
				<sl-lens-lowercase></sl-lens-lowercase>
				<sl-lens-reverse></sl-lens-reverse>
			</study-lenses>

			<div class="checklist">
				<strong>Manual Verification Checklist:</strong>
				<ul>
					<li>‚òê Receives code from parent study-lenses</li>
					<li>‚òê Transforms code correctly in panel mode</li>
					<li>‚òê Other lenses also receive same original code</li>
					<li>‚òê No interference between components</li>
					<li>‚òê Layout and spacing work properly</li>
				</ul>
			</div>
		</div>

		<!-- Import and register components -->
		<script type="module">
			// Register all components needed for testing
			import './register.js';
			import '../reverse/register.js';
			import '../../study/register.js';

			console.log('‚úÖ Lowercase lens component test loaded successfully');

			// Add interactive testing helpers
			window.testLowercaseLens = {
				// Helper function to test lens directly
				testFunction(code, config = {}) {
					const { lens } = import('./lens.js');
					const { config: configFactory } = import('./config.js');

					return lens.then((lensFunc) => {
						const snippet = { code, lang: 'js', test: false };
						return lensFunc.lens(snippet, configFactory(config));
					});
				},

				// Test various code samples
				testSamples() {
					const samples = [
						'SIMPLE TEXT',
						'FUNCTION TEST() { RETURN "HELLO"; }',
						'MIXED cAsE tExT',
						'123 NUMBERS AND SYMBOLS !@#',
					];

					samples.forEach((sample, i) => {
						console.log(`Sample ${i + 1}: "${sample}"`);
						this.testFunction(sample).then((result) => {
							console.log(
								`Result ${i + 1}: "${result.snippet.code}"`
							);
						});
					});
				},
			};

			// Validate components after page load
			document.addEventListener('DOMContentLoaded', () => {
				console.log('üîç Performing lowercase component validation...');

				setTimeout(() => {
					const lowercaseElements =
						document.querySelectorAll('sl-lens-lowercase');
					console.log(
						`Found ${lowercaseElements.length} lowercase components`
					);

					let allWorking = true;
					lowercaseElements.forEach((el, i) => {
						const hasContent = el.textContent.trim().length > 0;
						if (!hasContent) {
							console.warn(
								`‚ö†Ô∏è  Lowercase component ${i + 1} appears to have no content`
							);
							allWorking = false;
						} else {
							const content = el.textContent.trim();
							const hasUppercase = /[A-Z]/.test(content);
							if (hasUppercase) {
								console.warn(
									`‚ö†Ô∏è  Lowercase component ${i + 1} still contains uppercase letters`
								);
								allWorking = false;
							}
						}
					});

					if (allWorking) {
						console.log(
							'‚úÖ All lowercase components appear to be working correctly'
						);
					} else {
						console.log(
							'‚ùå Some lowercase components may not be working correctly'
						);
					}

					// Test the function directly
					console.log('üß™ Testing direct lens import...');
					window.testLowercaseLens
						.testFunction('HELLO WORLD')
						.then((result) => {
							console.log(
								'‚úÖ Direct lens function test passed:',
								result.snippet.code
							);
						})
						.catch((err) => {
							console.error(
								'‚ùå Direct lens function test failed:',
								err
							);
						});
				}, 1500); // Wait for components to initialize
			});
		</script>
	</body>
</html>

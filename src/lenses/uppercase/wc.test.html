<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Uppercase Lens Component Test</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        border: 2px solid #ddd;
        border-radius: 8px;
        background: white;
      }
      .test-section.pass {
        border-color: #28a745;
        background: #f8fff9;
      }
      .test-section.fail {
        border-color: #dc3545;
        background: #fff8f8;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
      }
      .checklist {
        margin: 10px 0;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 4px;
      }
      .checklist li {
        margin: 5px 0;
      }
      .expected {
        color: #666;
        font-style: italic;
        background: #e9ecef;
        padding: 8px;
        border-radius: 4px;
        margin: 10px 0;
      }
      h1 {
        color: #007acc;
      }
      h2 {
        color: #333;
        margin-top: 0;
      }
      .transform-output {
        border: 1px solid #ddd;
        margin: 10px 0;
        border-radius: 4px;
        padding: 5px;
      }
    </style>
  </head>
  <body>
    <h1>üß™ Uppercase Lens Component Test</h1>
    <p>Testing the sl-lens-uppercase web component that converts code to uppercase.</p>

    <!-- Test 1: Basic uppercase transformation -->
    <div class="test-section">
      <h2>Test 1: Basic Uppercase Transformation</h2>
      <div class="expected">
        <strong>Expected:</strong> Should convert "hello world" to "HELLO WORLD"
      </div>

      <div class="transform-output">
        <sl-lens-uppercase code="hello world"></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Shows "HELLO WORLD" (all uppercase)</li>
          <li>‚òê Original case is completely converted</li>
          <li>‚òê No console errors</li>
          <li>‚òê Component renders immediately</li>
        </ul>
      </div>
    </div>

    <!-- Test 2: Mixed case text -->
    <div class="test-section">
      <h2>Test 2: Mixed Case Text</h2>
      <div class="expected">
        <strong>Expected:</strong> Should handle mixed case and convert all to uppercase
      </div>

      <div class="transform-output">
        <sl-lens-uppercase code="HeLLo WoRLd! ThIs Is MiXeD cAsE."></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê All letters converted to uppercase</li>
          <li>‚òê Punctuation and spaces preserved</li>
          <li>‚òê Special characters remain unchanged</li>
          <li>‚òê Output is readable and correct</li>
        </ul>
      </div>
    </div>

    <!-- Test 3: JavaScript code transformation -->
    <div class="test-section">
      <h2>Test 3: JavaScript Code Transformation</h2>
      <div class="expected">
        <strong>Expected:</strong> Should convert JavaScript keywords and identifiers to uppercase
      </div>

      <div class="transform-output">
        <sl-lens-uppercase
          code="function test() { const message = 'hello'; return message.toUpperCase(); }"
        ></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê All keywords converted: FUNCTION, CONST, RETURN</li>
          <li>‚òê Identifier names converted: TEST, MESSAGE</li>
          <li>‚òê String content converted: 'HELLO'</li>
          <li>‚òê Method names converted: TOUPPERCASE()</li>
          <li>‚òê Code structure preserved</li>
        </ul>
      </div>
    </div>

    <!-- Test 4: File loading -->
    <div class="test-section">
      <h2>Test 4: File Path Loading</h2>
      <div class="expected">
        <strong>Expected:</strong> Should load file content and convert to uppercase
      </div>

      <div class="transform-output">
        <sl-lens-uppercase code="../examples/content/greet.js"></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê File loads successfully (or shows appropriate error)</li>
          <li>‚òê Loaded content is converted to uppercase</li>
          <li>‚òê File path is resolved correctly</li>
          <li>‚òê Loading state handled appropriately</li>
        </ul>
      </div>
    </div>

    <!-- Test 5: Empty and edge cases -->
    <div class="test-section">
      <h2>Test 5: Empty and Edge Cases</h2>
      <div class="expected">
        <strong>Expected:</strong> Should handle empty strings and special cases gracefully
      </div>

      <h3>Empty Code:</h3>
      <div class="transform-output">
        <sl-lens-uppercase code=""></sl-lens-uppercase>
      </div>

      <h3>Numbers and Symbols Only:</h3>
      <div class="transform-output">
        <sl-lens-uppercase code="123456 !@#$%^&*() []{}"></sl-lens-uppercase>
      </div>

      <h3>Unicode Characters:</h3>
      <div class="transform-output">
        <sl-lens-uppercase code="h√©llo w√∂rld üöÄ √©mojis"></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Empty code handled without errors</li>
          <li>‚òê Numbers and symbols remain unchanged</li>
          <li>‚òê Unicode characters converted correctly</li>
          <li>‚òê Emoji characters preserved</li>
          <li>‚òê No visual glitches or layout issues</li>
        </ul>
      </div>
    </div>

    <!-- Test 6: Configuration attributes -->
    <div class="test-section">
      <h2>Test 6: Configuration and Attributes</h2>
      <div class="expected">
        <strong>Expected:</strong> Should accept various attributes without breaking
      </div>

      <h3>With Lang Attribute:</h3>
      <div class="transform-output">
        <sl-lens-uppercase code="python_code = 'hello'" lang="python"></sl-lens-uppercase>
      </div>

      <h3>With Test Attribute:</h3>
      <div class="transform-output">
        <sl-lens-uppercase
          code="describe('test', () => { expect(true).toBe(true); });"
          test
        ></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Lang attribute doesn't interfere with transformation</li>
          <li>‚òê Test attribute is handled gracefully</li>
          <li>‚òê Additional attributes don't cause errors</li>
          <li>‚òê Core functionality remains unchanged</li>
        </ul>
      </div>
    </div>

    <!-- Test 7: TextContent fallback -->
    <div class="test-section">
      <h2>Test 7: TextContent as Code Source</h2>
      <div class="expected">
        <strong>Expected:</strong> Should use element textContent when no code attribute
      </div>

      <div class="transform-output">
        <sl-lens-uppercase>console.log("hello from textcontent");</sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê TextContent used as code source</li>
          <li>‚òê Content converted to uppercase</li>
          <li>‚òê Fallback mechanism works correctly</li>
          <li>‚òê No duplication of content</li>
        </ul>
      </div>
    </div>

    <!-- Test 8: Multiline code -->
    <div class="test-section">
      <h2>Test 8: Multiline Code Transformation</h2>
      <div class="expected">
        <strong>Expected:</strong> Should preserve line breaks while converting case
      </div>

      <div class="transform-output">
        <sl-lens-uppercase
          code="function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log(fibonacci(10));"
        ></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê All lines converted to uppercase</li>
          <li>‚òê Line breaks preserved</li>
          <li>‚òê Indentation maintained</li>
          <li>‚òê Code structure remains readable</li>
          <li>‚òê Multi-line display works correctly</li>
        </ul>
      </div>
    </div>

    <!-- Test 9: Integration with other components -->
    <div class="test-section">
      <h2>Test 9: Integration in Study Panel</h2>
      <div class="expected">
        <strong>Expected:</strong> Should work correctly within study-lenses component
      </div>

      <study-lenses code="const greeting = 'hello world'; console.log(greeting);">
        <sl-lens-uppercase></sl-lens-uppercase>
        <sl-lens-reverse></sl-lens-reverse>
      </study-lenses>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Receives code from parent study-lenses</li>
          <li>‚òê Transforms code correctly in panel mode</li>
          <li>‚òê Other lenses also receive same original code</li>
          <li>‚òê No interference between components</li>
          <li>‚òê Layout and spacing work properly</li>
        </ul>
      </div>
    </div>

    <!-- Test 10: Chaining with other transformations -->
    <div class="test-section">
      <h2>Test 10: Code Readability After Transformation</h2>
      <div class="expected">
        <strong>Expected:</strong> Should maintain code readability even after uppercase conversion
      </div>

      <div class="transform-output">
        <sl-lens-uppercase
          code="class Calculator {
  constructor() {
    this.value = 0;
  }
  
  add(number) {
    this.value += number;
    return this;
  }
  
  subtract(number) {
    this.value -= number;
    return this;
  }
  
  getValue() {
    return this.value;
  }
}

const calc = new Calculator();
calc.add(10).subtract(5);"
        ></sl-lens-uppercase>
      </div>

      <div class="checklist">
        <strong>Manual Verification Checklist:</strong>
        <ul>
          <li>‚òê Class definition clearly visible</li>
          <li>‚òê Method names and structure preserved</li>
          <li>‚òê Chained method calls remain readable</li>
          <li>‚òê Constructor and property access clear</li>
          <li>‚òê Overall code structure maintained</li>
        </ul>
      </div>
    </div>

    <!-- Import and register components -->
    <script type="module">
      // Register all components needed for testing
      import './register.js';
      import '../reverse/register.js';
      import '../../study/register.js';

      console.log('‚úÖ Uppercase lens component test loaded successfully');

      // Add interactive testing helpers
      window.testUppercaseLens = {
        // Helper function to test lens directly
        testFunction(code, config = {}) {
          const { lens } = import('./lens.js');
          const { config: configFactory } = import('./config.js');

          return lens.then((lensFunc) => {
            const snippet = { code, lang: 'js', test: false };
            return lensFunc.lens(snippet, configFactory(config));
          });
        },

        // Test various code samples
        testSamples() {
          const samples = [
            'simple text',
            'function test() { return "hello"; }',
            'MiXeD cAsE tExT',
            '123 numbers and symbols !@#',
          ];

          samples.forEach((sample, i) => {
            console.log(`Sample ${i + 1}: "${sample}"`);
            this.testFunction(sample).then((result) => {
              console.log(`Result ${i + 1}: "${result.snippet.code}"`);
            });
          });
        },
      };

      // Validate components after page load
      document.addEventListener('DOMContentLoaded', () => {
        console.log('üîç Performing uppercase component validation...');

        setTimeout(() => {
          const uppercaseElements = document.querySelectorAll('sl-lens-uppercase');
          console.log(`Found ${uppercaseElements.length} uppercase components`);

          let allWorking = true;
          uppercaseElements.forEach((el, i) => {
            const hasContent = el.textContent.trim().length > 0;
            if (!hasContent) {
              console.warn(`‚ö†Ô∏è  Uppercase component ${i + 1} appears to have no content`);
              allWorking = false;
            } else {
              const content = el.textContent.trim();
              const hasLowercase = /[a-z]/.test(content);
              if (hasLowercase) {
                console.warn(`‚ö†Ô∏è  Uppercase component ${i + 1} still contains lowercase letters`);
                allWorking = false;
              }
            }
          });

          if (allWorking) {
            console.log('‚úÖ All uppercase components appear to be working correctly');
          } else {
            console.log('‚ùå Some uppercase components may not be working correctly');
          }

          // Test the function directly
          console.log('üß™ Testing direct lens import...');
          window.testUppercaseLens
            .testFunction('hello world')
            .then((result) => {
              console.log('‚úÖ Direct lens function test passed:', result.snippet.code);
            })
            .catch((err) => {
              console.error('‚ùå Direct lens function test failed:', err);
            });
        }, 1500); // Wait for components to initialize
      });
    </script>
  </body>
</html>
